---

title : "Ansible 예제 - 호스트 사용자 목록"
date : 2019-11-06 10:00:00 + 0000
tags: Ansible
category: IaC

---

# Intro

이번 포스트에서는 호스트 사용자 목록을 Ansible Playbook을 사용하여 다루는 예제를 정리하였다.

***

# /etc/passwd 파일(리눅스 사용자 정보가 저장된 파일)을 읽어들여 사용자 이름의 목록을 얻는 플레이북

## Inventory 파일 작성
```
$ su - ansible
$ vi ~/playbook/hosts

아래와 같이 작성
[targets]
127.0.0.1

#[targets:vars]
#ansible_connection=ssh
#ansible_user=ansible
#ansible_ssh_pass={패스워드}
#ansible_sudo_pass={패스워드}
```

## Playbook 작성
```
$ vi ~/playbook/nginx/nginx.yml

아래와 같이 작성
---
- name: 플리이북 튜토리얼
  hosts: all
  become: true
  tasks:
    - name: libselinux-python 설치
      yum:
        name: libselinux-python
        state: present
    - name: EPEL 리포지토리 설치
      yum:
        name: epel-release
        state: present
    - name: nginx 설치
      yum:
        name: nginx
        state: present
    - name: nginx 서비스 시작과 자동 시작 설정
      service:
        name: nginx
        state: started
        enabled: true  
```

## Ansible 실행
```
$ cd ~/playbook
$ ansible-playbook -i hosts ./nginx/nginx.yml
```

출력 확인(이미 설치되었기 떄문에 ok로 출력된다.)
```
PLAY [플리이북 튜토리얼] *************************************************************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************************************************************
ok: [127.0.0.1]

TASK [libselinux-python 설치] **************************************************************************************************************************************************************
ok: [127.0.0.1]

TASK [EPEL 리포지토리 설치] *********************************************************************************************************************************************************************
ok: [127.0.0.1]

TASK [nginx 설치] **************************************************************************************************************************************************************************
ok: [127.0.0.1]

TASK [nginx 서비스 시작과 자동 시작 설정] ************************************************************************************************************************************************************
ok: [127.0.0.1]

PLAY RECAP *******************************************************************************************************************************************************************************
127.0.0.1                  : ok=5    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

***

# 참고 사이트
- https://zigispace.net/920
